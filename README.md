## Описание проекта

# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```

## Описание проекта

Интернет-магазин для веб-разработчиков — Web-ларёк. В данном проекте можно просматривать каталог товаров, добавлять их в корзину и оформлять заказы, разработанный в парадигме MPV.

## Интерфейсы для отображения моделей данных, а так же данные и типы данных, используемые в приложении 

Интерфейс, представляющий состояние страницы:
counter: число, представляющее текущее состояние или количество элементов на странице.
catalog: массив элементов типа HTMLElement, содержащих каталог доступных товаров или объектов.
locked: логическое значение, указывающее, заблокирована ли страница для взаимодействия.

```
interface IPage {
	counter: number;
	catalog: HTMLElement[];
	locked: boolean;
}

```

Интерфейс, используемый для представления данных модального окна:
content: элемент типа HTMLElement, содержащий контент, отображаемый в модальном окне.

```
interface IModalData {
	content: HTMLElement;
}

```

Интерфейс, описывающий состояние формы:
valid: логическое значение, определяющее, является ли форма валидной.
errors: массив строк, содержащий сообщения об ошибках валидации формы.

```
interface IFormState {
	valid: boolean;
	errors: string[];
}

```

Интерфейс для API, описывающий методы получения данных с сервера

```
export interface IWebLarekAPI {
	getProductList: () => Promise<IProduct[]>;
	getProductItem: (id: string) => Promise<IProduct>;
	orderProducts: (order: IOrder) => Promise<IOrderResult>;
}

```

Интерфейс для обработки событий

```
export interface IEvents {
    on<T extends object>(event: EventName, callback: (data: T) => void): void;
    emit<T extends object>(event: string, data?: T): void;
    trigger<T extends object>(event: string, context?: Partial<T>): (data: T) => void;
}

```

Описание продукта, содержащего поля, приходящие с сервера

```
export interface IProduct {
	id: string;
	description: string;
	image: string;
	title: string;
	category: string;
	price: number | null;
}

```

Описание корзины, содержащей список товаров и итоговую стоимость

```
export interface IBasket {
	items: string[];
	total: number;
}

```

Тип для валидации полей ввода

```
export type OrderForm = Omit<IOrder, 'total' | 'items'>;

```

Методы оплаты

```
export type PaymentMethod = 'cash' | 'card';

```

Описание заказа, содержащего поля для составления валидного заказа

```
export interface IOrder extends IContactsForm {
	payment: PaymentMethod;
	email: string;
	phone: string;
	address: string;
	items: string[];
	total: number;
}
```

Результат заказа, содержащий идентификатор созданного заказа и количество списанной валюты

```
export interface IOrderResult {
	id: string;
	total: number;
}
```

## Архитектура приложения

Код приложения организован по слоям в соответствии с парадигмой MVP:

### Базовый код

#### Класс Api

Содержит основную логику для отправки запросов. В конструкторе принимаются базовый адрес сервера и необязательный объект с заголовками. Его методы:

get: выполняет GET-запрос к указанному эндпоинту и возвращает промис с объектом ответа от сервера.

post: принимает объект с данными, которые будут отправлены в формате JSON в теле запроса, и передает их на заданный эндпоинт. По умолчанию используется POST-запрос, однако метод запроса можно изменить, задав третий параметр при вызове.

#### Абстрактный класс Component

Основной класс для всех элементов представления. Основные методы:

setText: устанавливает текстовое содержимое.

setImage: устанавливает изображение.

setVisible: отображает элемент.

setDisable: устанавливает статус блокировки.

setHidden: скрывает элемент.

render: возвращает элемент разметки для отображения на странице.

#### Класс EventEmitter

Брокер событий, который позволяет отправлять и подписываться на события, возникающие в системе. Класс применяется в презентере для обработки событий, а также в других слоях приложения для их генерации. Основные методы, реализованные классом, описаны в интерфейсе IEvents:

on: подписка на событие.

emit: инициация события.

trigger: возвращает функцию, при вызове которой инициируется указанное событие.

Дополнительно реализованы методы onAll и offAll для подписки на все события и отмены всех подписок.

### Слой данных

#### Класс View

В его конструкторе принимаются два параметра: container и events.

Класс является наследником Component и вводит поле events типа IEvents. IEvents предназначено для управления событиями компонента.

#### Класс WebLarekAPI

Содержит:

getProductList — извлекает список всех доступных продуктов с сервера.

getProductItem — получает подробную информацию о продукте по его идентификатору.

orderProducts — отправляет информацию о заказе на сервер и возвращает результат операции.

#### Класс Component

Содержит методы:

setText — задает текстовое содержимое элемента.

setDisabled — включает или выключает блокировку элемента.

setImage — задает изображение и альтернативный текст.

toggleClass — переключает класс элемента.

render — основной метод, возвращающий корневой DOM-элемент компонента.

### Слой отображения

#### Класс App Data

Класс, являющийся хранилищем всех данных приложения.

Содержит методы:

setItems(items: IProduct[]) — назначает список продуктов и инициирует событие изменения этого списка.
setPreview(item: IProduct) — задает предпросмотр товара и вызывает событие изменения предпросмотра.
setPaymentMethod(method: PaymentMethod) — задает способ оплаты для заказа.
setOrderField(field: keyof OrderForm, value: string) — устанавливает значения полей заказа и проверяет их корректность.

addToBasket(item: IProduct) — добавляет товар в корзину и вызывает событие изменения состояния корзины.
inBasket(item: IProduct) — определяет, присутствует ли товар в корзине.

removeFromBasket(item: IProduct) — исключает товар из корзины и инициирует событие изменения корзины.
clearBasket() — очищает корзину и вызывает событие изменения состояния корзины.

validateOrder() — проверяет корректность заказа и инициирует событие изменения ошибок в форме заказа.

#### Класс Page

Класс, отвечающий за отображение всего каталога товаров и главной страницы. Поля этого класса:

_counter: HTMLElement — элемент, отображающий количество товаров в корзине.
_catalog: HTMLElement — элемент для отображения каталога товаров.
_wrapper: HTMLElement — элемент-обертка основного контента страницы.
_basket: HTMLElement — элемент корзины на странице.

Содержит методы:

set counter - метод, устанавливающий значения счетчика.
set catalog - метод, устанавливающий содержиме каталога на странице.
set locked - метод, устанавливающий состояние блокировки прокрутки страницы.

#### Класс Modal

Класс для работы с модальными окнами

Поля класса:

_closeButton: HTMLButtonElement — кнопка для закрытия модального окна.
_content: HTMLElement — контент модального окна, представляющий всё его содержимое.

Содержит методы:

content — метод, задающий новое содержимое модального окна, заменяя старое.
open — метод, открывающий модальное окно.
close — метод, закрывающий модальное окно.

#### Класс Basket

Класс для отображения корзины содержит следующие поля и методы:

template — статическое поле, содержащее HTML-шаблон корзины.

_list — приватное поле для хранения ссылки на элемент корзины.
_total — приватное поле для хранения ссылки на элемент, отображающий общую сумму.
_button — приватное поле для хранения ссылки на элемент кнопки оформления заказа.

selected — метод для установки выбранных товаров. Если есть выбранные товары, кнопка оформления заказа активируется, в противном случае — деактивируется.
items — метод для установки списка товаров в корзине. Если список не пуст, он заменяет элементы внутри контейнера корзины. В случае пустого списка отображается сообщение "Корзина пуста", и обновляется состояние кнопки оформления заказа.
total — метод для установки общей суммы товаров в корзине.

#### Класс Success

Класс наследует Component и представляет компонент для отображения модального окна с уведомлением об успешном оформлении заказа. 
Его конструктор принимает опциональные действия actions типа ISuccessActions и контейнер элемента container типа HTMLFormElement. 
В этом конструкторе вызывается родительский конструктор Component с переданным контейнером.

### Описание событий необходимых для работы приложения